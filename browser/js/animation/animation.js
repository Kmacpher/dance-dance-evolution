app.config(function($stateProvider) {
    $stateProvider.state('animation', {
        url: '/animation',
        templateUrl: 'js/animation/animation.html',
        controller: function($scope, ArrowFactory, ToneFactory) {

            function move() {
                console.log('moving shiz');
            };

            var testChart = [
                [
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0']
                ],
                [
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '1']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '1'],
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '1']
                ],
                [
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '1']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0']
                ],
                [
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '0', '0', '1'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '0']
                ],
                [
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '0']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '1'],
                    ['2', '0', '0', '0']
                ],
                [
                    ['0', '1', '0', '0'],
                    ['3', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '2']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '0', '1', '3'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0']
                ],
                [
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '0', '0', '1'],
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0']
                ],
                [
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1']
                ],
                [
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['1', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '2', '0', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '3', '0', '0']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['2', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['3', '0', '0', '0']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '2'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '3']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '1', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '1', '0', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '1'],
                    ['0', '0', '1', '0'],
                    ['0', '1', '0', '1']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['1', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['1', '1', '0', '0']
                ],
                [
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0']
                ],
                [
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '1', '0']
                ],
                [
                    ['0', '1', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '1'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0']
                ],
                [
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '1']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '2', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '3', '0', '0'],
                    ['0', '0', '0', '0']
                ],
                [
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '0', '1']
                ],
                [
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '0', '1', '0'],
                    ['0', '0', '0', '1']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '1'],
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '1']
                ],
                [
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '1'],
                    ['0', '0', '1', '0'],
                    ['1', '0', '0', '1']
                ],
                [
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '1', '0', '0'],
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0']
                ],
                [
                    ['0', '0', '0', '1'],
                    ['0', '1', '0', '0'],
                    ['1', '0', '0', '0'],
                    ['0', '0', '2', '0']
                ],
                [
                    ['0', '0', '0', '0'],
                    ['0', '0', '0', '0'],
                    ['0', '0', '3', '0'],
                    ['0', '0', '0', '0'],
                    [';']
                ]
            ]
            ArrowFactory.makeTimeline();
            testChart.forEach(function(measure, chIndex) {
                var notes = measure.length;
                measure.forEach(function(note, mIndex) {
                    note.forEach(function(maybeArrow, index) {
                        if (maybeArrow !== '0') {
                            var dir = ArrowFactory.indexToDir(index);
                            var arrow = new ArrowFactory(dir, 1);
                            arrow.animate(191.94, chIndex, mIndex, notes);
                        }
                    })
                })
            });

            var listener = function(){
              console.log("IVE BEEN SHOT");
            };
            var tone = new ToneFactory("/audio/321 STARS.mp3", 191.94, 2.7-0.67239, ".67239");
            testChart.forEach(function(measure, mIndex) {
              var notes = measure.length;
              measure.forEach(function(note, nIndex) {
                if(note[0] !== '0') {
                  tone.transport.setTimeline(function(time) {
                    document.body.addEventListener("click", listener)
                  }, `${mIndex}m + ${notes}n * ${nIndex} - 16n`);
                  tone.transport.setTimeline(function(time) {
                    document.body.removeEventListener("click", listener)
                  }, `${mIndex}m + ${notes}n * ${nIndex} + 16n`);
                }
              });
            });


            $scope.runInit = function () {
                ArrowFactory.resumeTimeline();
                tone.start();
            }




            // var player = new Tone.Player("/audio/321 STARS.mp3").toMaster();
            // Tone.Buffer.onload = function() {
            //     player.start("+1.8");
            //     Tone.Transport.start(".67239", "0:0:0");
            // }
            //
            // Tone.Transport.bpm.value = 191.94;

        }
    });
});
